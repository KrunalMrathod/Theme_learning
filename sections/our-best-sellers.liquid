{{ 'our-best-sellers.css' | asset_url | stylesheet_tag }}
{{ 'slick-theme.css' | asset_url | stylesheet_tag }}
{{ 'slick.css' | asset_url | stylesheet_tag }}

<div class="section-our-bestsellers">
  <div class="page-width">
    <div class="title-box">
      <div class="main-box">
        <h2>{{ section.settings.title }}</h2>
      </div>
      <div class="right-corner">
        <div class="progress-bar">
          <span class="slider__label sr-only">20% completed</span>
        </div>
        <div class="d-flex">
          <div class="prevArrow slide-button slick-arrow">
            <svg width="40" height="40" viewBox="0 0 40 40" fill="#231F20" xmlns="http://www.w3.org/2000/svg">
              <circle cx="20" cy="20" r="20" transform="matrix(-1 0 0 1 40 0)" fill="#E5E5E5"></circle>
              <path d="M21.4688 13.4688L15.75 19.4688C15.6042 19.6146 15.5312 19.7812 15.5312 19.9688C15.5312 20.1562 15.6042 20.3333 15.75 20.5L21.4688 26.4688C21.8021 26.7604 22.1562 26.7708 22.5312 26.5C22.8229 26.1458 22.8229 25.7917 22.5312 25.4375L17.2812 19.9375L22.5312 14.5312C22.8229 14.1562 22.8229 13.8021 22.5312 13.4688C22.1562 13.1771 21.8021 13.1771 21.4688 13.4688Z" fill="#231F20"></path>
            </svg>
          </div>
          <div class="nextArrow slide-button slick-arrow">
            <svg width="40" height="40" viewBox="0 0 40 40" fill="#231F20" xmlns="http://www.w3.org/2000/svg">
              <circle cx="20" cy="20" r="20" fill="#E5E5E5"></circle>
              <path d="M18.5312 13.4688L24.25 19.4688C24.3958 19.6146 24.4688 19.7812 24.4688 19.9688C24.4688 20.1562 24.3958 20.3333 24.25 20.5L18.5312 26.4688C18.1979 26.7604 17.8438 26.7708 17.4688 26.5C17.1771 26.1458 17.1771 25.7917 17.4688 25.4375L22.7188 19.9375L17.4688 14.5312C17.1771 14.1562 17.1771 13.8021 17.4688 13.4688C17.8438 13.1771 18.1979 13.1771 18.5312 13.4688Z" fill="#231F20"></path>
            </svg>
          </div>
        </div>
      </div>
    </div>

    <div class="your-class">
      {% for block in section.blocks %}
        <div class="product-card">
          <div class="img-box">
            <a href="{{ block.settings.product_link }}" class="custom-full-unstyled-link" tabindex="-1">
              <span class="visually-hidden">{{ block.settings.product_name }}</span>
            </a>
            {% if block.settings.product_image %}
              <img
                src="{{ block.settings.product_image | image_url }}"
                width="260"
                height="260"
                alt="{{ block.settings.product_name }}"
                loading="lazy"
              >
            {% else %}
              <img
                src="https://images.unsplash.com/photo-1628155930542-3c7a64e2c833?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
                alt="Fallback Image"
                width="260"
                height="260"
              >
            {% endif %}
          </div>
          <div class="transform-box">
            <div class="name-box">
              <span>{{ block.settings.product_name }}</span>
              <div class="d-flex">
                <div class="star-box">
                  <img
                    src="https://liraclinical.com/cdn/shop/t/18/assets/star.svg?v=127067073641318785891733292159"
                    width="14"
                    height="14"
                    loading="lazy"
                    alt="star"
                  >
                  <span> {{ block.settings.product_ratings }} </span>
                </div>
              </div>
            </div>
          </div>
          <div class="buttons_signin_signup">
            <a href="{{ block.settings.product_link }}" class="product_submit main-cta" tabindex="-1">View more</a>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script src="{{ 'jquery.min.js' | asset_url }}" defer></script>
<script src="{{ 'slick.min.js' | asset_url }}" defer></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    $('.your-class').slick({
      dots: false,
      infinite: false,
      speed: 500,
      slidesToShow: 4,
      slidesToScroll: 1,
      prevArrow: $('.prevArrow'),
      nextArrow: $('.nextArrow'),
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 2,
          },
        },
        {
          breakpoint: 767,
          settings: {
            slidesToShow: 1,
          },
        },
      ],
    });

    let sliderContainer = document.querySelector('.slick-track').children.length;
    let nextButton = document.querySelector('.nextArrow');
    let progressBar = document.querySelector('.progress-bar');
    let slidesToShow = 4;
    let totalSlides = sliderContainer;
    let progressStep = 100 / Math.ceil(totalSlides / slidesToShow);

    $('.your-class').on('afterChange', function (event, slick, currentSlide) {
      let progress = ((currentSlide + slidesToShow) / totalSlides) * 100;
      progressBar.style.backgroundSize = `${progress}% 100%`;
    });

    nextButton.addEventListener('click', function () {
      let currentProgress = parseFloat(progressBar.style.backgroundSize) || 0;
      progressBar.style.backgroundSize = `${Math.min(currentProgress + progressStep, 100)}% 100%`;
    });
  });
</script>

{% schema %}
{
  "name": "Our Best Sellers",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Best Sellers"
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "text",
          "id": "product_name",
          "label": "Product name"
        },
        {
          "type": "image_picker",
          "id": "product_image",
          "label": "Product image"
        },
        {
          "type": "number",
          "id": "product_ratings",
          "label": "Product ratings"
        },
        {
          "type": "url",
          "id": "product_link",
          "label": "Product link"
        }
      ]
    }
  ],

  "presets": [
    {
      "name": "Our Best Sellers"
    }
  ]
}
{% endschema %}
